<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Daily IQ & Focus Trainer</title>

  <!-- Content Security Policy (Basis, lokal erlaubt) -->
  <meta http-equiv="Content-Security-Policy"
        content="default-src 'self' data:; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; font-src https://fonts.gstatic.com; img-src 'self' data:; script-src 'self' 'unsafe-inline';" />

  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500;700&family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg:#050505;--accent:#00ffcc;--accent2:#00c3ff;--text:#f0f0f0;--muted:#888;--danger:#ff4d6a;--card-bg:rgba(255,255,255,0.05);--card-border:rgba(0,255,200,0.15);
    }
    *{box-sizing:border-box;transition:all .3s ease;}
    body{margin:0;background:radial-gradient(circle at top,#0a0a0a,#000);color:var(--text);font-family:'Poppins',sans-serif;overflow-x:hidden;}
    header{padding:3rem 1rem;text-align:center;}
    header h1{margin:0;font-size:3rem;text-transform:uppercase;font-family:'Orbitron',sans-serif;letter-spacing:2px;background:linear-gradient(90deg,var(--accent),var(--accent2));-webkit-background-clip:text;-webkit-text-fill-color:transparent;animation:glow 3s ease-in-out infinite alternate;}
    header .quote{color:var(--accent);font-style:italic;font-size:1.2rem;margin-top:1rem;max-width:720px;margin-left:auto;margin-right:auto;animation:fadeIn 4s ease-in-out;font-weight:500;text-wrap:balance;}
    @keyframes glow{from{text-shadow:0 0 10px var(--accent);}to{text-shadow:0 0 25px var(--accent2);}}
    @keyframes fadeIn{from{opacity:0;}to{opacity:1;}}

    main{max-width:1000px;margin:3rem auto;padding:2.5rem;background:rgba(15,15,15,0.85);border-radius:20px;backdrop-filter:blur(10px);box-shadow:0 0 25px rgba(0,255,200,0.3);display:grid;grid-template-columns:1fr 280px;gap:2rem;}
    @media(max-width:900px){main{grid-template-columns:1fr;}}

    h2{color:var(--accent);font-family:'Orbitron',sans-serif;margin-top:0;text-align:left;font-size:1.5rem;}

    /* Tabs / Navigation */
    .tab-buttons{display:flex;gap:1rem;flex-wrap:wrap;margin-bottom:1.5rem;justify-content:center;}

    /* Cards / Fragen */
    .question{background:var(--card-bg);border:1px solid var(--card-border);border-radius:16px;padding:1.4rem;margin:1rem 0;box-shadow:0 0 20px rgba(0,255,200,0.1);}
    .question h3{margin-top:0;font-size:1.1rem;line-height:1.5;color:var(--text);}

    /* Buttons */
    button.option,button.start-btn,button.danger-btn,#consentOk{padding:0.7rem 1.3rem;border:none;border-radius:12px;cursor:pointer;background:linear-gradient(90deg,var(--accent2),var(--accent));color:#000;font-weight:600;min-width:140px;font-size:1rem;box-shadow:0 0 15px rgba(0,255,200,0.4);}
    button.option:hover,button.start-btn:hover,button.danger-btn:hover,#consentOk:hover{transform:scale(1.08);box-shadow:0 0 20px rgba(0,255,200,0.6);}
    button.danger-btn{background:linear-gradient(90deg,var(--danger),#ff8b4d);box-shadow:0 0 15px rgba(255,77,106,0.5);color:#000;}
    button.small{min-width:auto;font-size:.9rem;padding:.5rem 1rem;}

    .card-center{text-align:center;padding:2rem;background:var(--card-bg);border:1px solid var(--card-border);border-radius:16px;max-width:400px;margin:0 auto 2rem;box-shadow:0 0 20px rgba(0,255,200,0.1);}
    .start-hint{color:var(--muted);font-size:.9rem;margin-top:.8rem;}

    /* Screens */
    .screen{display:none;}
    .screen.active{display:block;}

    .result-line{font-size:1.1rem;color:var(--accent);font-weight:500;min-height:1.4rem;}

    /* Sidebar */
    aside .sidebar-card{background:var(--card-bg);border:1px solid var(--card-border);border-radius:16px;padding:1rem;box-shadow:0 0 20px rgba(0,255,200,0.1);font-size:.9rem;}
    .sidebar-title{margin-top:0;color:var(--accent);font-family:'Orbitron',sans-serif;font-size:0.8rem;letter-spacing:.05em;text-transform:uppercase;}
    .sidebar-line{font-size:1rem;color:var(--text);} 
    .sidebar-note{color:var(--muted);font-size:.8rem;}

    /* Statistik */
    .stats-block{background:var(--card-bg);border:1px solid var(--card-border);border-radius:14px;padding:1rem;margin-bottom:1rem;font-size:.95rem;box-shadow:0 0 16px rgba(0,255,200,0.08);}
    .stats-block h3{margin-top:0;font-size:1rem;color:var(--accent);font-family:'Orbitron',sans-serif;letter-spacing:.05em;}
    .history-list{list-style:none;padding-left:1rem;color:var(--text);font-size:.9rem;}
    .history-list li{margin-bottom:.4rem;color:var(--muted);}

    footer{text-align:center;padding:1.5rem 1rem;color:var(--muted);font-size:0.9rem;margin-top:4rem;grid-column:1 / -1;}

    /* Consent Banner */
    .consent-banner{position:fixed;left:1rem;right:1rem;bottom:1rem;background:#000;border:1px solid var(--card-border);box-shadow:0 0 20px rgba(0,255,200,0.4);border-radius:14px;padding:1rem;font-size:.8rem;color:var(--text);display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:1rem;max-width:600px;margin:0 auto;z-index:9999;}
  </style>
</head>
<body>
  <header>
    <p class="quote">„Der Mensch ist der Mittelpunkt der Welt, weil er denkt.“ – Ibn Sina (Avicenna)</p>
    <h1>Daily IQ & Focus Trainer</h1>
  </header>

  <main>
    <section id="contentArea">
      <!-- Navigation Buttons -->
      <div class="tab-buttons">
        <button data-screen="intro" class="option">Start</button>
        <button data-screen="iqTest" class="option">IQ‑Test</button>
        <button data-screen="psyTest" class="option">Psyche</button>
        <button data-screen="stats" class="option">Statistik</button>
      </div>

      <!-- INTRO / START -->
      <section id="intro" class="screen active">
        <div class="card-center">
          <button id="startBtn" class="start-btn">Test starten</button>
          <p class="start-hint">Deine Ergebnisse werden nur lokal auf deinem Gerät gespeichert.</p>
        </div>
      </section>

      <!-- IQ TEST -->
      <section id="iqTest" class="screen">
        <h2>IQ‑Test</h2>
        <div id="iqQuestions"></div>
        <p id="iqResult" class="result-line"></p>
      </section>

      <!-- PSYCHE TEST -->
      <section id="psyTest" class="screen">
        <h2>Psyche‑Analyse</h2>
        <div id="psyQuestions"></div>
        <p id="psyResult" class="result-line"></p>
      </section>

      <!-- STATS / VERLAUF -->
      <section id="stats" class="screen">
        <h2>Deine Statistik</h2>
        <div class="stats-block">
          <div><strong>Letzter IQ‑Score:</strong> <span id="statLastIQ">–</span></div>
          <div><strong>Letzte Psyche‑Einstufung:</strong> <span id="statPsyLevel">–</span></div>
        </div>

        <div class="stats-block">
          <h3>Historie</h3>
          <ul id="historyList" class="history-list"></ul>
        </div>

        <button id="clearDataBtn" class="danger-btn">Alle gespeicherten Daten löschen</button>
      </section>
    </section>

    <!-- SIDEBAR -->
    <aside>
      <div class="sidebar-card">
        <h4 class="sidebar-title">Live Status</h4>
        <div class="sidebar-line">Aktiver Test: <span id="liveTest">–</span></div>
        <div class="sidebar-line">Frage #: <span id="liveQuestion">0</span></div>
        <div class="sidebar-line">Score: <span id="liveScore">0</span></div>
        <div class="sidebar-note" id="liveNote">Bereit.</div>
      </div>
    </aside>

    <footer>© 2025 Daily IQ & Focus Trainer</footer>
  </main>

  <!-- CONSENT-BANNER (DSGVO Style) -->
  <div id="consentBanner" class="consent-banner">
    <div>Lokale Auswertung aktiv. Deine Ergebnisse bleiben nur in deinem Browser (LocalStorage).</div>
    <button id="consentOk" class="start-btn small">OK</button>
  </div>

  <script>
    // =====================
    // Screen Handling / Navigation
    // =====================
    const screens = document.querySelectorAll('.screen');
    const navButtons = document.querySelectorAll('.tab-buttons button');
    const liveTestEl = document.getElementById('liveTest');
    const liveQuestionEl = document.getElementById('liveQuestion');
    const liveScoreEl = document.getElementById('liveScore');
    const liveNoteEl = document.getElementById('liveNote');

    function showScreen(id){
      screens.forEach(s => s.classList.remove('active'));
      document.getElementById(id).classList.add('active');
      liveTestEl.textContent = id === 'iqTest' ? 'IQ‑Test'
        : id === 'psyTest' ? 'Psyche'
        : '–';
      liveNoteEl.textContent = id === 'psyTest' ? 'Ehrlich antworten.' : 'Bereit.';
      if(id === 'stats'){
        updateStatsDisplay();
      }
    }

    navButtons.forEach(btn=>{
      btn.addEventListener('click',()=>{
        const target = btn.getAttribute('data-screen');
        showScreen(target);
      });
    });

    // =====================
    // Consent Banner (Datenschutz Hinweis)
    // =====================
    const consentBanner = document.getElementById('consentBanner');
    const consentOk = document.getElementById('consentOk');
    if(localStorage.getItem('consentAccepted') === '1'){
      consentBanner.style.display = 'none';
    }
    consentOk.addEventListener('click',()=>{
      localStorage.setItem('consentAccepted','1');
      consentBanner.style.display = 'none';
    });

    // =====================
    // IQ‑Test Logik
    // =====================
    const iqQuestions = [
      {q:'Was ist 9 × 9?',a:['72','81','99'],c:1},
      {q:'Was ergibt 5³?',a:['25','125','225'],c:1},
      {q:'Welche Zahl folgt: 2,4,8,16,?',a:['24','32','36'],c:1},
      {q:'Wähle das Gegenteil von „chaotisch“',a:['geordnet','hektisch','nervös'],c:0},
      {q:'Was ist 20% von 400?',a:['40','60','80'],c:2}
    ];

    let iqIndex = 0;
    let iqScore = 0;
    const iqContainer = document.getElementById('iqQuestions');
    const iqResult = document.getElementById('iqResult');

    function renderIQ() {
      if(iqIndex >= iqQuestions.length) {
        const text = `Dein IQ‑Score: ${iqScore} / ${iqQuestions.length}`;
        iqResult.textContent = text;
        saveResult({ type:'iq', score: iqScore, total: iqQuestions.length, ts: Date.now() });
        updateStatsDisplay();
        return;
      }

      const q = iqQuestions[iqIndex];
      liveQuestionEl.textContent = iqIndex+1;
      liveScoreEl.textContent = iqScore;
      iqContainer.innerHTML = `
        <div class="question">
          <h3>${q.q}</h3>
          ${q.a.map((opt,i)=>`<button class="option" data-i="${i}">${opt}</button>`).join('')}
        </div>
      `;

      iqContainer.querySelectorAll('button.option').forEach(btn=>{
        btn.addEventListener('click',()=>{
          const chosen = Number(btn.getAttribute('data-i'));
          if(chosen === q.c) iqScore++;
          iqIndex++;
          renderIQ();
        });
      });
    }

    // =====================
    // Psyche‑Analyse Logik
    // =====================
    const psyQuestions = [
      {q:'Wie oft fühlst du dich unter Druck?',a:['Nie','Selten','Oft'],s:[1,2,3]},
      {q:'Kannst du gut abschalten?',a:['Ja','Teilweise','Nein'],s:[1,2,3]},
      {q:'Wie stabil fühlst du dich in Konflikten?',a:['Sehr stabil','Unsicher','Instabil'],s:[1,2,3]}
    ];

    const psyContainer = document.getElementById('psyQuestions');
    const psyResult = document.getElementById('psyResult');
    let psyAnswers = [];

    function renderPsy(){
      psyContainer.innerHTML = '';
      psyAnswers = [];

      psyQuestions.forEach((item, idx) => {
        const block = document.createElement('div');
        block.classList.add('question');
        block.innerHTML = `
          <h3>${item.q}</h3>
          ${item.a.map((ans,i)=>`<button class="option" data-question="${idx}" data-score="${item.s[i]}">${ans}</button>`).join('')}
        `;
        psyContainer.appendChild(block);
      });

      psyContainer.querySelectorAll('button.option').forEach(btn=>{
        btn.addEventListener('click',()=>{
          const qIndex = Number(btn.getAttribute('data-question'));
          const score  = Number(btn.getAttribute('data-score'));
          psyAnswers[qIndex] = score;

          // wenn alle beantwortet
          if(psyAnswers.filter(v=>v!==undefined).length === psyQuestions.length){
            const total = psyAnswers.reduce((a,b)=>a+b,0);
            let msg;
            if(total <= 4) msg = 'Sehr entspannt';
            else if(total <= 6) msg = 'Leichte Anspannung';
            else msg = 'Erhöhtes Stresslevel';

            psyResult.textContent = msg;
            saveResult({ type:'psy', level: msg, score: total, ts: Date.now() });
            updateStatsDisplay();
          }
        });
      });
    }

    // =====================
    // LocalStorage Persistenz & Statistik
    // =====================
    const statLastIQ = document.getElementById('statLastIQ');
    const statPsyLevel = document.getElementById('statPsyLevel');
    const historyList = document.getElementById('historyList');
    const clearDataBtn = document.getElementById('clearDataBtn');

    function saveResult(entry){
      const raw = localStorage.getItem('history');
      const hist = raw ? JSON.parse(raw) : [];
      hist.push(entry);
      if(hist.length > 50) hist.shift();
      localStorage.setItem('history', JSON.stringify(hist));
    }

    function updateStatsDisplay(){
      const raw = localStorage.getItem('history');
      const hist = raw ? JSON.parse(raw) : [];

      // letzter IQ
      const lastIQ = [...hist].reverse().find(e=>e.type==='iq');
      statLastIQ.textContent = lastIQ ? `${lastIQ.score} / ${lastIQ.total}` : '–';

      // letzte Psyche
      const lastPsy = [...hist].reverse().find(e=>e.type==='psy');
      statPsyLevel.textContent = lastPsy ? lastPsy.level : '–';

      // History-Liste
      historyList.innerHTML = '';
      hist.slice().reverse().forEach(entry=>{
        let line='';
        if(entry.type==='iq'){
          line = `IQ: ${entry.score}/${entry.total}`;
        } else if(entry.type==='psy'){
          line = `Psyche: ${entry.level} (Score ${entry.score})`;
        }
        const li = document.createElement('li');
        const date = new Date(entry.ts).toLocaleString();
        li.textContent = `${date} – ${line}`;
        historyList.appendChild(li);
      });
    }

    clearDataBtn.addEventListener('click',()=>{
      localStorage.removeItem('history');
      updateStatsDisplay();
    });

    // =====================
    // Start Button Verhalten
    // =====================
    const startBtn = document.getElementById('startBtn');
    startBtn.addEventListener('click',()=>{
      showScreen('iqTest');
      renderIQ();
      startBtn.disabled = true;
      startBtn.textContent = 'Läuft...';
    });

    // Initial Psyche-Blöcke rendern (damit Psyche-Tab bereit ist)
    renderPsy();
  </script>
</body>
</html>


